const crypto = require("crypto");

const senderPublicKeyPem = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvN6ewPmDRZEfySSmrOPY
JUdlELsPEHXtqYLJImdDe9Sb5PA4BLR1AgxLyh8RBvGk8eBxgM/47TC/j2hxcGdG
dVE9abGFXL40t/u7VCadKf7FlSpC61Bcek73efmlKF2KBuRzzwdYXN6XF+nxPJUM
WUuCwn67LiRkxHDjfjGyBj6doGGzAFUxuOds3KQSkstJ5d8nv3wAAtxAY+16Ty0/
AUVuump0vMqbI0/y7evnTutvqmIIJld4zAEAYB/Yy802ZEynCU6qg5AmWqQtVIZE
TGuiOY3/7rs5D875MPXtszzi2dNe2SJqCVqZA63eJ/3utS++EoKsGD8txyxp6uy+
rwIDAQAB
-----END PUBLIC KEY-----`;

const senderPublicKey = crypto.createPublicKey(senderPublicKeyPem);

const recipientPrivateKeyPem = `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC83p7A+YNFkR/J
JKas49glR2UQuw8Qde2pgskiZ0N71Jvk8DgEtHUCDEvKHxEG8aTx4HGAz/jtML+P
aHFwZ0Z1UT1psYVcvjS3+7tUJp0p/sWVKkLrUFx6Tvd5+aUoXYoG5HPPB1hc3pcX
6fE8lQxZS4LCfrsuJGTEcON+MbIGPp2gYbMAVTG452zcpBKSy0nl3ye/fAAC3EBj
7XpPLT8BRW66anS8ypsjT/Lt6+dO62+qYggmV3jMAQBgH9jLzTZkTKcJTqqDkCZa
pC1UhkRMa6I5jf/uuzkPzvkw9e2zPOLZ017ZImoJWpkDrd4n/e61L74SgqwYPy3H
LGnq7L6vAgMBAAECggEAPsvOAN909AZiiSA0grtmvE5Wng9z3Mc48+lWMqge2edA
xgfQuE+/r6Si9lsJ8EMb0ogLdQaw/zv8FRRm0zajSJJwVtn9O27KXHnIORx1mObq
jsP0aATaGphy1A1bCma/Y7dFggoxKP+hQQQ5fykXaAEhQsWcOqVDE8Vs/iJLzKMm
0Po68G/8nJkNSLIboDrcLlyqk/0P6/T35rk1GDK9vHqH337nKgqVTsda/KSkbKth
vKo/XT2pbSwtFSX4lhURhma8a1dBdOj5ytCJZgWbvXlqVvPjK8pSpAQbwMM3D/1U
Hx+UjIieDnszGfwvVqOxN9sFun2QB2prLtA68dc4oQKBgQDcfmN5Sk/dvX7CSNkz
RnnKB0vk1r1bhVykSFhazq60BghFQ8TFvm5tLv6mUzpjFM8+Rm7bHhXen7kzoRes
lKld8XdxG1bM3CNlFuaf6pkLLzxfPgfdehZDki2qOSZ2cuF3ddN5JACYJSZ4Jc8O
3+NjKE7kG6/TLG1WXa14ZJt/dwKBgQDbSJAYjIOivLkHCoGs3prmO0jV1AxNHcjg
Co7B65h7/91cSYYYh/YpwYJdH2ivzG2m/hEoYsc40KWSyXnIrnA9KbsGfPmSXhvq
vUNdizXI4SjfZdhlbQmLa9WFhJHV0A9tyDHDBkz0FxVaKXf4oHC73ZBzE5GdEBIB
OOkzJqi4iQKBgQDAYysqZpO/N5uFrAiQO9sCU1F+L3xzga6uzU0ClrpK68SFozbr
D1jMvaeFurMERuD5Rn1thRex8w2mpdXBSMlq5cjBEQiwoRflGZFLUWgOIT39IGO+
dMs+VCqyD0GnMl/WWyGU3rwCBNBHHz5GjUWbfE0xrZLBoE8af4xfsvEWywKBgB7u
EUUlLLwbmo2fscLMc1TeL9vZWRLXjKntU02PCacT5AlMZZm4M8SYAudXstB5KU5Q
r+Lea/Nbmr8lpAPmdvZpmHPF1P4MQCvQHlxncmKvP7CjEO7dfmcoAqoelONvwX1e
q4YysVAMoXpiNwXeu4gELIfOzs80oRWDDYGlhk7hAoGAZQUWNP+Ys6tSow1gndbk
PggVxS1cTwTSyviFkAB4kt6vEmp0bCWDxiWy8Iv/jr7J9OHqssWp8N/EKx6Fnys9
5oVhcqXxYuTSn8r3HPJw1ouRfgqLzHMQqiCiQfQlJS5b423frb0m8taYGGgxgKiz
Fi29Xc2R3QJ52vv55gBLajE=
-----END PRIVATE KEY-----`;

const recipientPrivateKey = crypto.createPrivateKey(recipientPrivateKeyPem);

const signatureHex =
  "0736563d23a0085bd0309ccfbaae70caf1a3de095d0091e8bd88ff9901ad612cab24f00a05f2b2be16214d1f6fd62e4f069119c790baa18fd4958bfb5af569af4aa4276706be876fba8f4b4c64957f6f0e4f0e6f7d5a7edb61f51fda403c620c4adbd6a6702e9a1e33f9a60046ba21c413297a2ab7609b3d278c011c261c69f38a60bd166a068609a9c6a7a3f63121024f943a94ed1b03611d5a4bd33cd30348b13cb00694457958442a83d5b13ef5fd59e5cf1cc40466c323c83d5d855a3c21ec27d73debbeb95972fc6e5c62ee20aacfa7f58d95d3d76ca624ea00d051a869acdec6400e620f3149ad3de3e8eabddefc637cdb13bf6f4bbc160ac0e7c14cc1";
const signature = Buffer.from(signatureHex, "hex");

const ciphertextHex =
  "a927ec7f6d1655638da0b6a7dd00d397856d04d13d8512f91b192663286ebb3e8b60c306a7c25849ed2c5435a06efd1f278c71d6e738bbffab9abe4cab64988334ca3951176873cbb7b9f2c44c9aa32f72aa98374d28d89845aa139de75a2879bb22e9e11499b36cf446617d9e3f53861dfaebe550b60e057df83e988afbdf0cd6a8c2cb6b9471a802905d1e5dc14b475360d023738bd768a9d4d8a196bec8c0fa5fa877ec238b32366697321a7863eff810971fbe870c9f2c211d912d34f7b031f4452d0cf80c4e1e970bfecee59cfb7418eea4b99500e35858e4032e8ebe68754e25c650341cd3f79b848073c9a04f2f10e4c835a6196369a5ef2da6bbc4b8";
const ciphertext = Buffer.from(ciphertextHex, "hex");
const recoveredPlaintext = crypto.privateDecrypt(
  recipientPrivateKey,
  ciphertext
);
const data = Buffer.from(recoveredPlaintext.toString("utf8"));
const isValid = crypto.verify("sha256", data, senderPublicKey, signature);
console.log("Signature Verification:", isValid);
console.log("Message:", recoveredPlaintext.toString("utf8"));
